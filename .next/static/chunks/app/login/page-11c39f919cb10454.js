(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{546:(e,t,r)=>{Promise.resolve().then(r.bind(r,7527))},6046:(e,t,r)=>{"use strict";var n=r(6658);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},7146:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,AuthProvider:()=>a});var n=r(5155),o=r(2115),s=r(8547);let i=(0,o.createContext)(null);function a(e){let{children:t}=e,[r,a]=(0,o.useState)(null);return(0,o.useEffect)(()=>{if((0,s.c4)()){let e=localStorage.getItem("username");e&&a(e)}},[]),(0,n.jsx)(i.Provider,{value:{username:r,setUsername:a,logout:()=>{(0,s.QF)(),localStorage.removeItem("username"),a(null)}},children:t})}function c(){let e=(0,o.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},7527:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var n=r(5155),o=r(2115),s=r(8173),i=r.n(s),a=r(6046),c=r(8547),l=r(7146);function d(){let e=(0,a.useRouter)(),{setUsername:t}=(0,l.A)(),[r,s]=(0,o.useState)(!0),[d,u]=(0,o.useState)(""),[h,m]=(0,o.useState)(""),[f,p]=(0,o.useState)(""),[x,g]=(0,o.useState)(""),[v,w]=(0,o.useState)(!1),b=async n=>{if(n.preventDefault(),g(""),!r){if(h!==f){g("Passwords do not match");return}if(h.length<8){g("Password must be at least 8 characters long");return}}w(!0);try{r?await (0,c.iD)(d,h):await (0,c.$5)(d,h),localStorage.setItem("username",d),t(d),e.push("/")}catch(e){g(e instanceof Error?e.message:"An unexpected error occurred")}finally{w(!1)}};return(0,n.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-black to-indigo-950",children:(0,n.jsxs)("div",{className:"w-full max-w-sm",children:[(0,n.jsx)("div",{className:"text-center mb-8",children:(0,n.jsx)(i(),{href:"/",className:"inline-block",children:(0,n.jsxs)("h1",{className:"text-4xl font-bold text-white tracking-tight",children:["FigArt ",(0,n.jsx)("span",{className:"text-indigo-400",children:"AI"})]})})}),(0,n.jsxs)("div",{className:"bg-white/5 backdrop-blur-xl rounded-2xl p-6 shadow-2xl shadow-black/40 border border-white/10",children:[(0,n.jsx)("h2",{className:"text-xl text-white font-medium mb-6",children:r?"Welcome back":"Create account"}),x&&(0,n.jsx)("div",{className:"mb-6 text-sm text-red-400 bg-red-950/50 border border-red-500/20 rounded-lg p-3",children:x}),(0,n.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-white/70 mb-1.5",children:"Username"}),(0,n.jsx)("input",{type:"text",id:"username",value:d,onChange:e=>u(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white placeholder-white/30 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all",placeholder:"Enter your username",required:!0,disabled:v})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-white/70 mb-1.5",children:"Password"}),(0,n.jsx)("input",{type:"password",id:"password",value:h,onChange:e=>m(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white placeholder-white/30 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all",placeholder:r?"Enter your password":"Create a password",required:!0,disabled:v}),!r&&(0,n.jsx)("p",{className:"mt-1 text-xs text-white/50",children:"Must be at least 8 characters long"})]}),!r&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-white/70 mb-1.5",children:"Confirm Password"}),(0,n.jsx)("input",{type:"password",id:"confirmPassword",value:f,onChange:e=>p(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white placeholder-white/30 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all",placeholder:"Confirm your password",required:!0,disabled:v})]}),r&&(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)(i(),{href:"/forgot-password",className:"text-sm text-indigo-400 hover:text-indigo-300 transition-colors",children:"Forgot password?"})}),(0,n.jsx)("button",{type:"submit",disabled:v,className:"w-full bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg px-4 py-2.5 font-medium focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-transparent disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:v?(0,n.jsxs)("div",{className:"flex items-center justify-center",children:[(0,n.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-2",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r?"Signing in...":"Creating account..."]}):(0,n.jsx)("span",{children:r?"Sign in":"Create account"})})]}),(0,n.jsx)("div",{className:"mt-6 text-center",children:(0,n.jsx)("button",{onClick:()=>{s(!r),g(""),m(""),p("")},className:"text-sm text-indigo-400 hover:text-indigo-300 transition-colors",disabled:v,children:r?"Don't have an account? Sign up":"Already have an account? Sign in"})})]}),(0,n.jsxs)("div",{className:"mt-8 text-center text-sm text-white/40",children:["By continuing, you agree to our"," ",(0,n.jsx)(i(),{href:"/terms",className:"text-indigo-400 hover:text-indigo-300",children:"Terms of Service"})," ","and"," ",(0,n.jsx)(i(),{href:"/privacy",className:"text-indigo-400 hover:text-indigo-300",children:"Privacy Policy"})]})]})})}},8134:(e,t,r)=>{"use strict";r.d(t,{H$:()=>o,ed:()=>s});var n=r(2818);let o=()=>{if(console.log("Environment variables:",{NEXT_PUBLIC_API_URL:n.env.NEXT_PUBLIC_API_URL}),n.env.NEXT_PUBLIC_API_URL)return console.log("Using API URL from environment variable:",n.env.NEXT_PUBLIC_API_URL),n.env.NEXT_PUBLIC_API_URL;{let{protocol:e,hostname:t}=window.location;if(console.log("Current hostname:",t),"localhost"===t||"127.0.0.1"===t){let r="".concat(e,"//").concat(t,":8000");return console.log("Using local API URL:",r),r}let r="".concat(e,"//").concat(t,":8000");return console.log("Using dynamic API URL based on hostname:",r),r}},s=e=>{let t="".concat(o(),"/photos/").concat(e);return console.log("Photo URL generated:",t),t}},8547:(e,t,r)=>{"use strict";function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}r.d(t,{AT:()=>h,c4:()=>c,iD:()=>d,QF:()=>l,$5:()=>u});var o=function e(t,r){function o(e,o,s){if("undefined"!=typeof document){"number"==typeof(s=n({},r,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var a in s){if(s[a])i+="; "+a,!0!==s[a]&&(i+="="+s[a].split(";")[0])}return document.cookie=e+"="+t.write(o,e)+i}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},o=0;o<r.length;o++){var s=r[o].split("="),i=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(n[a]=t.read(i,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){o(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),s=r(8134);let i="auth_token",a=e=>{o.set(i,e,{expires:7})},c=()=>o.get(i),l=()=>{o.remove(i)},d=async(e,t)=>{let r=await fetch("".concat((0,s.H$)(),"/users/login/"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",mode:"cors",body:JSON.stringify({username:e,password:t})}),n=await r.json().catch(()=>null);if(!r.ok){if(401===r.status)throw Error("Invalid username or password");throw Error((null==n?void 0:n.detail)||"Login failed")}if(!(null==n?void 0:n.token))throw Error("No token received");return a(n.token),n},u=async(e,t)=>{let r=await fetch("".concat((0,s.H$)(),"/users/register/"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",mode:"cors",body:JSON.stringify({username:e,password:t})}),n=await r.json().catch(()=>null);if(!r.ok){if(409===r.status)throw Error("Username already exists");throw Error((null==n?void 0:n.detail)||"Registration failed")}if(!(null==n?void 0:n.token))throw Error("No token received");return a(n.token),n},h=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=c(),n={"Content-Type":"application/json",Accept:"application/json",...r&&{Authorization:"Bearer ".concat(r)},...t.headers},o=await fetch("".concat((0,s.H$)()).concat(e),{...t,headers:n,credentials:"include",mode:"cors"}),i=await o.json().catch(()=>null);if(!o.ok)throw Error((null==i?void 0:i.detail)||"API request failed");return i}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,587,358],()=>t(546)),_N_E=e.O()}]);