(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[880],{1698:(e,t,s)=>{Promise.resolve().then(s.bind(s,7317))},6046:(e,t,s)=>{"use strict";var r=s(6658);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},7146:(e,t,s)=>{"use strict";s.d(t,{A:()=>i,AuthProvider:()=>l});var r=s(5155),o=s(2115),n=s(8547);let a=(0,o.createContext)(null);function l(e){let{children:t}=e,[s,l]=(0,o.useState)(null);return(0,o.useEffect)(()=>{if((0,n.c4)()){let e=localStorage.getItem("username");e&&l(e)}},[]),(0,r.jsx)(a.Provider,{value:{username:s,setUsername:l,logout:()=>{(0,n.QF)(),localStorage.removeItem("username"),l(null)}},children:t})}function i(){let e=(0,o.useContext)(a);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},7317:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(5155),o=s(2115),n=s(6046),a=s(8173),l=s.n(a),i=s(8547),c=s(7146),d=s(8134);function m(){let{id:e}=(0,n.useParams)(),t=(0,n.useRouter)(),{username:s}=(0,c.A)(),[a,m]=(0,o.useState)(null),[u,x]=(0,o.useState)([]),[h,p]=(0,o.useState)(!0),[g,f]=(0,o.useState)(null),[w,v]=(0,o.useState)(!1),[j,b]=(0,o.useState)(""),[y,N]=(0,o.useState)(!1),[k,C]=(0,o.useState)(!1),[L,_]=(0,o.useState)(!1),[A,E]=(0,o.useState)(!1),[P,S]=(0,o.useState)(!1),[B,T]=(0,o.useState)(null);(0,o.useEffect)(()=>{if(g){let e=setTimeout(()=>{f(null)},5e3);return()=>clearTimeout(e)}},[g]),(0,o.useEffect)(()=>{let t=async()=>{try{p(!0);let t=await (0,i.AT)("/posts/".concat(e,"/"));m(t.post);let r=await (0,i.AT)("/posts/".concat(e,"/comments/")),o=r.comments?r.comments.filter(t=>t.post_id===Number(e)):[];if(x(o),s)try{let t=await (0,i.AT)("/users/liked-posts/");t&&t.liked_posts&&v(t.liked_posts.includes(Number(e)))}catch(e){console.error("Error checking liked status:",e)}}catch(e){console.error("Error fetching post details:",e),f("Failed to load post details")}finally{p(!1)}};e&&t()},[e,s]);let U=async()=>{if(!s){f("You must be logged in to like posts");return}try{f(null);let t=w?"/posts/".concat(e,"/thumbs-down/"):"/posts/".concat(e,"/thumbs-up/");v(!w),a&&m({...a,thumbs_up:w?Math.max(0,a.thumbs_up-1):a.thumbs_up+1}),await (0,i.AT)(t,{method:"POST"})}catch(e){console.error("Error liking post:",e),v(!w),a&&m({...a,thumbs_up:w?a.thumbs_up+1:Math.max(0,a.thumbs_up-1)}),e instanceof Error?f(e.message):f("Failed to update like status")}},I=async t=>{if(t.preventDefault(),!s){f("You must be logged in to comment");return}if(!j.trim()){f("Comment cannot be empty");return}try{N(!0),f(null);let t=await (0,i.AT)("/posts/".concat(e,"/comment/add/"),{method:"POST",body:JSON.stringify({comment:j})});if(t&&t.comment_id){let r={id:t.comment_id,post_id:Number(e),user_id:s,content:j,created_at:new Date().toISOString()};x([...u,r]),b("")}}catch(e){console.error("Error adding comment:",e),e instanceof Error?f(e.message):f("Failed to add comment")}finally{N(!1)}},R=async()=>{if(!a||a.user_id!==s){f("You do not have permission to delete this post");return}C(!0)},D=async()=>{try{_(!0),f(null),await (0,i.AT)("/posts/".concat(e,"/delete/"),{method:"POST"}),t.push("/community")}catch(e){console.error("Error deleting post:",e),e instanceof Error?f(e.message):f("Failed to delete post"),C(!1),_(!1)}},M=e=>{if(e.user_id!==s){f("You do not have permission to delete this comment");return}T(e),E(!0)},z=async()=>{if(B)try{S(!0),f(null),await (0,i.AT)("/posts/".concat(e,"/comment/").concat(B.id,"/delete/"),{method:"POST"}),x(u.filter(e=>e.id!==B.id)),E(!1),T(null)}catch(e){console.error("Error deleting comment:",e),e instanceof Error?f(e.message):f("Failed to delete comment")}finally{S(!1)}};return h?(0,r.jsxs)("div",{className:"min-h-screen",children:[g&&(0,r.jsx)("div",{className:"fixed top-0 left-0 right-0 z-[99999] flex justify-center items-start pt-0 bg-transparent",style:{position:"fixed",top:"80px"},role:"alert",children:(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md shadow-lg max-w-md w-full pointer-events-auto",children:[(0,r.jsx)("strong",{className:"font-bold",children:"Error: "}),(0,r.jsx)("span",{className:"block sm:inline",children:g}),(0,r.jsx)("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>f(null),"aria-label":"Close error message",children:(0,r.jsxs)("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[(0,r.jsx)("title",{children:"Close"}),(0,r.jsx)("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]})}),(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-2 sm:px-3 lg:px-4 py-8",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)(l(),{href:"/community",className:"text-white hover:text-indigo-300 flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),"Back to Community"]})}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-md p-12",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"}),(0,r.jsx)("p",{className:"mt-4 text-gray-500 text-lg",children:"Loading post details..."})]})})]})]}):a?(0,r.jsxs)("div",{className:"min-h-screen",children:[g&&(0,r.jsx)("div",{className:"fixed top-0 left-0 right-0 z-[99999] flex justify-center items-start pt-0 bg-transparent",style:{position:"fixed",top:"80px"},role:"alert",children:(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md shadow-lg max-w-md w-full pointer-events-auto",children:[(0,r.jsx)("strong",{className:"font-bold",children:"Error: "}),(0,r.jsx)("span",{className:"block sm:inline",children:g}),(0,r.jsx)("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>f(null),"aria-label":"Close error message",children:(0,r.jsxs)("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[(0,r.jsx)("title",{children:"Close"}),(0,r.jsx)("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]})}),k&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[99999] flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Delete Post"}),(0,r.jsx)("p",{className:"text-gray-700 mb-6",children:"Are you sure you want to delete this post? This action cannot be undone."}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400",disabled:L,children:"Cancel"}),(0,r.jsx)("button",{onClick:D,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500",disabled:L,children:L?(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete Post"})]})]})}),A&&B&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[99999] flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Delete Comment"}),(0,r.jsx)("p",{className:"text-gray-700 mb-6",children:"Are you sure you want to delete this comment? This action cannot be undone."}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{E(!1),T(null)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400",disabled:P,children:"Cancel"}),(0,r.jsx)("button",{onClick:z,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500",disabled:P,children:P?(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete Comment"})]})]})}),(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-2 sm:px-3 lg:px-4 py-8",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)(l(),{href:"/community",className:"text-white hover:text-indigo-300 flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),"Back to Community"]})}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative flex flex-col",children:[(0,r.jsx)("div",{className:"w-full bg-black flex items-center justify-center p-4 border-b border-gray-200",children:(0,r.jsx)("img",{src:(0,d.ed)(a.photo_uuid),alt:"Post by ".concat(a.user_id),className:"max-w-full max-h-[80vh] object-contain"})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-xl font-bold text-gray-900",children:["By ",(0,r.jsx)("span",{className:"text-indigo-600",children:a.user_id})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:new Date(a.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("button",{onClick:U,className:"flex items-center text-gray-500 hover:text-red-500 transition-colors focus:outline-none","aria-label":w?"Unlike post":"Like post",children:[w?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6 mr-1 text-red-500",children:(0,r.jsx)("path",{d:"M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z"})}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 mr-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),(0,r.jsx)("span",{className:"text-lg",children:a.thumbs_up})]}),a.user_id===s&&(0,r.jsx)("button",{onClick:R,className:"text-red-500 hover:text-red-700 focus:outline-none","aria-label":"Delete post",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})]})]})})]}),(0,r.jsxs)("div",{className:"p-6 border-t",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:["Comments (",u.length,")"]}),s?(0,r.jsx)("form",{onSubmit:I,className:"mb-6",children:(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsx)("textarea",{value:j,onChange:e=>b(e.target.value),placeholder:"Add a comment...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-gray-900",rows:2,maxLength:60}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[j.length,"/60 characters"]}),(0,r.jsx)("button",{type:"submit",disabled:y||!j.trim(),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors disabled:bg-indigo-400",children:y?"Posting...":"Post Comment"})]})]})}):(0,r.jsx)("div",{className:"mb-6 p-4 bg-gray-50 rounded-md text-center",children:(0,r.jsxs)("p",{className:"text-gray-600",children:[(0,r.jsx)(l(),{href:"/login",className:"text-indigo-600 hover:text-indigo-800 font-medium",children:"Log in"})," ","to add a comment"]})}),0===u.length?(0,r.jsx)("div",{className:"text-center py-4",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No comments yet. Be the first to comment!"})}):(0,r.jsx)("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:u.map(e=>(0,r.jsxs)("div",{className:"p-3 bg-gray-50 rounded-md",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.user_id}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mr-2",children:new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),e.user_id===s&&(0,r.jsx)("button",{onClick:()=>M(e),className:"text-gray-400 hover:text-red-500 transition-colors focus:outline-none","aria-label":"Delete comment",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})]})]}),(0,r.jsx)("p",{className:"mt-1 text-gray-700 text-sm",children:e.content})]},e.id))})]})]})]})]}):(0,r.jsxs)("div",{className:"min-h-screen",children:[g&&(0,r.jsx)("div",{className:"fixed top-0 left-0 right-0 z-[99999] flex justify-center items-start pt-0 bg-transparent",style:{position:"fixed",top:"80px"},role:"alert",children:(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md shadow-lg max-w-md w-full pointer-events-auto",children:[(0,r.jsx)("strong",{className:"font-bold",children:"Error: "}),(0,r.jsx)("span",{className:"block sm:inline",children:g}),(0,r.jsx)("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>f(null),"aria-label":"Close error message",children:(0,r.jsxs)("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[(0,r.jsx)("title",{children:"Close"}),(0,r.jsx)("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]})}),(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-2 sm:px-3 lg:px-4 py-8",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)(l(),{href:"/community",className:"text-white hover:text-indigo-300 flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),"Back to Community"]})}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-md p-12",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 mx-auto text-gray-400",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})}),(0,r.jsx)("h2",{className:"mt-4 text-2xl font-bold text-gray-900",children:"Post not found"}),(0,r.jsx)("p",{className:"mt-2 text-gray-500",children:"The post you're looking for doesn't exist or has been removed."}),(0,r.jsx)(l(),{href:"/community",className:"mt-6 inline-block px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:"Return to Community"})]})})]})]})}},8134:(e,t,s)=>{"use strict";s.d(t,{H$:()=>o,ed:()=>n});var r=s(2818);let o=()=>{if(console.log("Environment variables:",{NEXT_PUBLIC_API_URL:r.env.NEXT_PUBLIC_API_URL}),r.env.NEXT_PUBLIC_API_URL)return console.log("Using API URL from environment variable:",r.env.NEXT_PUBLIC_API_URL),r.env.NEXT_PUBLIC_API_URL;{let{protocol:e,hostname:t}=window.location;if(console.log("Current hostname:",t),"localhost"===t||"127.0.0.1"===t){let s="".concat(e,"//").concat(t,":8000");return console.log("Using local API URL:",s),s}let s="".concat(e,"//").concat(t,":8000");return console.log("Using dynamic API URL based on hostname:",s),s}},n=e=>{let t="".concat(o(),"/photos/").concat(e);return console.log("Photo URL generated:",t),t}},8547:(e,t,s)=>{"use strict";function r(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)e[r]=s[r]}return e}s.d(t,{AT:()=>u,c4:()=>i,iD:()=>d,QF:()=>c,$5:()=>m});var o=function e(t,s){function o(e,o,n){if("undefined"!=typeof document){"number"==typeof(n=r({},s,n)).expires&&(n.expires=new Date(Date.now()+864e5*n.expires)),n.expires&&(n.expires=n.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var l in n){if(n[l])a+="; "+l,!0!==n[l]&&(a+="="+n[l].split(";")[0])}return document.cookie=e+"="+t.write(o,e)+a}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var s=document.cookie?document.cookie.split("; "):[],r={},o=0;o<s.length;o++){var n=s[o].split("="),a=n.slice(1).join("=");try{var l=decodeURIComponent(n[0]);if(r[l]=t.read(a,l),e===l)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){o(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(s)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),n=s(8134);let a="auth_token",l=e=>{o.set(a,e,{expires:7})},i=()=>o.get(a),c=()=>{o.remove(a)},d=async(e,t)=>{let s=await fetch("".concat((0,n.H$)(),"/users/login/"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",mode:"cors",body:JSON.stringify({username:e,password:t})}),r=await s.json().catch(()=>null);if(!s.ok){if(401===s.status)throw Error("Invalid username or password");throw Error((null==r?void 0:r.detail)||"Login failed")}if(!(null==r?void 0:r.token))throw Error("No token received");return l(r.token),r},m=async(e,t)=>{let s=await fetch("".concat((0,n.H$)(),"/users/register/"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",mode:"cors",body:JSON.stringify({username:e,password:t})}),r=await s.json().catch(()=>null);if(!s.ok){if(409===s.status)throw Error("Username already exists");throw Error((null==r?void 0:r.detail)||"Registration failed")}if(!(null==r?void 0:r.token))throw Error("No token received");return l(r.token),r},u=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i(),r={"Content-Type":"application/json",Accept:"application/json",...s&&{Authorization:"Bearer ".concat(s)},...t.headers},o=await fetch("".concat((0,n.H$)()).concat(e),{...t,headers:r,credentials:"include",mode:"cors"}),a=await o.json().catch(()=>null);if(!o.ok)throw Error((null==a?void 0:a.detail)||"API request failed");return a}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,587,358],()=>t(1698)),_N_E=e.O()}]);